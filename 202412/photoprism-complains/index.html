<!doctype html>
<html lang="zh-cn">
  <head>
    <title>PhotoPrism缺点大吐槽：哪哪都不行，建议弃用 // 喵ฅ^•ﻌ•^ฅ</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta property="og:site_name" content="喵ฅ^•ﻌ•^ฅ">
    <meta name="generator" content="Hugo 0.111.3">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Ruohai Wang" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.da30c98f9942ec671d45447781f2ff089c06a4c2f4fc85c728b8f8755627a970.css" />
    

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PhotoPrism缺点大吐槽：哪哪都不行，建议弃用"/>
<meta name="twitter:description" content="前言 先声明：从去年的7~8月份我开始折腾自建相册，当时对比了immich最后选择了photoprism，至今也用了一年半的时间了，所以算是个老用户了，不是简单新手向的吐槽。
为什么用了一年半以后才开始写这个吐槽文，因为我自己用java写了一个小服务来处理照片归档，所以最后一个对pp的依赖也没有了，终于可以把pp从我的服务器上remove掉惹。
在放弃pp的这一刻，写篇文章记录一下我在使用pp的过程中碰到的几个超级大槽点。
超级大槽点 槽点一：照片统一重命名都按照UTC时区处理
这个是pp归档照片时最大的bug。
pp有个功能，就是按照统一规则生成一个唯一的文件名将照片进行重命名，所以最后的文件名都是yyyyMMdd_HHmmss_xxxxxxxx.jpg这种格式，其中最后8位x应该是类似md5一样根据文件生成的8位字符串。
这个功能很好用，也是强制启用的功能。按照这个规则重命名以后的照片/视频，根据文件名就能很方便的知道文件的创建时间，而且也统一了文件名，看上去很干净规整。
但是这个功能有个很大的bug！！！！
pp是按照utc时区来生成的文件名，也就是正确的照片时间需要减去8个小时来生成文件名！！！
比如某时某刻我拍了一张jpg照片，拍摄时间是2024年12月5日15点36分44秒，那照片归档正确的文件名应该是20241205_153644_xxxxxxxx.jpg。但是pp会无视照片exif中的时区信息，而是按照utc时区生成文件名，也就是北京时间减去8个小时，最后就变成了20241205_073644_xxxxxxxx.jpg。
(╯‵□′)╯︵┻━┻
不过，比起原始照片文件各种乱七八糟无规则、无意义、自然递增的文件名格式，现在这个文件名只是时间少了8个小时，好像也不是太大的问题。
那就要配合上下面这个大杀器！
槽点二：照片归档也按照UTC时区处理
pp归档图片和视频文件时，是根据文件的创建时间，按照yyyy/mm的目录结构来归档文件的。
但这个读取文件创建时间按照utc时区处理超级大槽点，这就导致了一种情况：
月初拍的照片有可能被归档到上个月！比如，2024年12月1号早上7点拍的照片，减去8小时是2024年11月30号晚上11点，就被归档到2024/11目录惹 年初拍的照片可能被归档到上一年！比如：2024年1月1日早上7点拍的照片，减去8小时候是2023年12月31日晚上11点，就被归档到2023/12目录惹 这种情况下，如果在pp中搜索2024年12月份的照片，或者搜2024年的照片，这种错误归档的照片就搜不到了！！！
(╯‵□′)╯︵┻━┻
我在使用photoprism的这一年半时间里，也想过是不是我什么地方没设置正确，比如是不是docker-compose.yml中没有加timezone参数，是不是服务器的时间设置错误。我在官方wiki和官方github issue里也找过，但实在是个人能力有限，没有找到什么有用的解决方法。
但我又非常喜欢pp这个按照文件时间统一重命名、统一归档的功能，另外几个相册（比如immich）都没有这个功能，所以最后我不得不在有如此两个大槽点的情况继续坚持使用pp。
槽点三：重命名操作会修改文件的exif
以图片文件为例，图片的exif中，保存文件时间的大致有如下几个tag：
Date/Time Original：原始创建时间 Date/Time Digitized：数字化时间 File Modified Date：文件修改时间 如果是拍摄生成的照片（手机、相机等拍摄设备），exif中都会有这几个tag，pp应该也是优先读取前两个tag进行时间解析，然后按照这个时间（别忘了会减去8小时）生成文件名。
但如果是非拍摄生成的图片（比如网上下载的图片、从微信保存的图片、各种截图），这种图片的exif中都没有前两个tag，只有File Modified Date保存了文件生成时间。对于这种图片，pp应该是读取File Modified Date，根据这个时间（依然要减去8个小时）生成文件名。如果读取的时间字符串无法正确解析，就会用当前时间生成文件名。
到这里似乎都没啥问题，有拍摄时间读取拍摄时间，没拍摄时间读取文件生成时间，无法读取文件生成时间就用当前时间。
但是，pp的骚操作又来啦！！！！
pp读取时间生成新的文件名并对文件进行重命名以后，会把这个修改操作的时间写入exif的File Modified Date。
这就导致了一个bug：对于非拍摄生成的图片，每导入一次，这张照片的File Modified Date都会被修改一次。如果恰巧又碰到了pp无法正确解析File Modified Date中保存的时间字符串，那这个文件就又会被归档到当前时间。
你可能会觉得奇怪，为什么会有傻x要把照片反复导入pp归档。
是我！是我！我就出现过这种操作！
比如我目前有8w个照片、图片、视频文件，全部导入pp进行归档，归档完成后删除了原始文件，保留了归档文件。然后很不幸我部署pp的系统崩了，但8w个已归档的文件还在。这时我重新部署一个pp，把8w个已经归档的文件又全部导入pp进行【二次归档】。
🤔🤔🤔🤔🤔🤔🤔🤔
这个时候我发现很多非拍摄生成的图片都被归档到当前时间惹！！！！！！
(╯‵□′)╯︵┻━┻
槽点四：图片算法识别功能很垃圾
pp作为一个完整的相册服务，也提供了图像算法识别功能，用来进行图像主体识别、人脸识别、自动标签、自动创建精彩时刻、图片质量打分等等智能功能。
但我实体使用下来的体验是：不好用，非常不好用。
不说和google、apple的图片算法识别比，也不和国内各个手机厂商提供的手机智能相册比，只是和immich比，我都感觉差了很多。主体识别错误、检测不到人脸、自动标签错误，很难说达到可用级别。
对于pp的图像识别算法功能，我的点评是：能用但是不好用，徒增功耗、浪费算力，建议关闭。
槽点五：免费版pp的gps解析功能有限制
相信很多pp用户和我一样都是用的免费社区版（community）做自建相册，pp免费版也带了照片地图功能，根据照片exif中保存的gps信息显示照片的拍摄地并显示在地图上。
但是，但是，pp的骚操作又又又来惹！！！
免费版pp根据gps坐标数据解析地理位置的api有请求数量限制！！！有rate limit！！！
也就是如果一次导入比较多的照片，很容易就达到这个reverse geocodeing接口的请求数量限制，这个api会直接报timeout错误让你以为是自己网络出了问题。
如果达到这个rate limit，很抱歉解析照片地理位置的功能就gg了。"/>

    <meta property="og:title" content="PhotoPrism缺点大吐槽：哪哪都不行，建议弃用" />
<meta property="og:description" content="前言 先声明：从去年的7~8月份我开始折腾自建相册，当时对比了immich最后选择了photoprism，至今也用了一年半的时间了，所以算是个老用户了，不是简单新手向的吐槽。
为什么用了一年半以后才开始写这个吐槽文，因为我自己用java写了一个小服务来处理照片归档，所以最后一个对pp的依赖也没有了，终于可以把pp从我的服务器上remove掉惹。
在放弃pp的这一刻，写篇文章记录一下我在使用pp的过程中碰到的几个超级大槽点。
超级大槽点 槽点一：照片统一重命名都按照UTC时区处理
这个是pp归档照片时最大的bug。
pp有个功能，就是按照统一规则生成一个唯一的文件名将照片进行重命名，所以最后的文件名都是yyyyMMdd_HHmmss_xxxxxxxx.jpg这种格式，其中最后8位x应该是类似md5一样根据文件生成的8位字符串。
这个功能很好用，也是强制启用的功能。按照这个规则重命名以后的照片/视频，根据文件名就能很方便的知道文件的创建时间，而且也统一了文件名，看上去很干净规整。
但是这个功能有个很大的bug！！！！
pp是按照utc时区来生成的文件名，也就是正确的照片时间需要减去8个小时来生成文件名！！！
比如某时某刻我拍了一张jpg照片，拍摄时间是2024年12月5日15点36分44秒，那照片归档正确的文件名应该是20241205_153644_xxxxxxxx.jpg。但是pp会无视照片exif中的时区信息，而是按照utc时区生成文件名，也就是北京时间减去8个小时，最后就变成了20241205_073644_xxxxxxxx.jpg。
(╯‵□′)╯︵┻━┻
不过，比起原始照片文件各种乱七八糟无规则、无意义、自然递增的文件名格式，现在这个文件名只是时间少了8个小时，好像也不是太大的问题。
那就要配合上下面这个大杀器！
槽点二：照片归档也按照UTC时区处理
pp归档图片和视频文件时，是根据文件的创建时间，按照yyyy/mm的目录结构来归档文件的。
但这个读取文件创建时间按照utc时区处理超级大槽点，这就导致了一种情况：
月初拍的照片有可能被归档到上个月！比如，2024年12月1号早上7点拍的照片，减去8小时是2024年11月30号晚上11点，就被归档到2024/11目录惹 年初拍的照片可能被归档到上一年！比如：2024年1月1日早上7点拍的照片，减去8小时候是2023年12月31日晚上11点，就被归档到2023/12目录惹 这种情况下，如果在pp中搜索2024年12月份的照片，或者搜2024年的照片，这种错误归档的照片就搜不到了！！！
(╯‵□′)╯︵┻━┻
我在使用photoprism的这一年半时间里，也想过是不是我什么地方没设置正确，比如是不是docker-compose.yml中没有加timezone参数，是不是服务器的时间设置错误。我在官方wiki和官方github issue里也找过，但实在是个人能力有限，没有找到什么有用的解决方法。
但我又非常喜欢pp这个按照文件时间统一重命名、统一归档的功能，另外几个相册（比如immich）都没有这个功能，所以最后我不得不在有如此两个大槽点的情况继续坚持使用pp。
槽点三：重命名操作会修改文件的exif
以图片文件为例，图片的exif中，保存文件时间的大致有如下几个tag：
Date/Time Original：原始创建时间 Date/Time Digitized：数字化时间 File Modified Date：文件修改时间 如果是拍摄生成的照片（手机、相机等拍摄设备），exif中都会有这几个tag，pp应该也是优先读取前两个tag进行时间解析，然后按照这个时间（别忘了会减去8小时）生成文件名。
但如果是非拍摄生成的图片（比如网上下载的图片、从微信保存的图片、各种截图），这种图片的exif中都没有前两个tag，只有File Modified Date保存了文件生成时间。对于这种图片，pp应该是读取File Modified Date，根据这个时间（依然要减去8个小时）生成文件名。如果读取的时间字符串无法正确解析，就会用当前时间生成文件名。
到这里似乎都没啥问题，有拍摄时间读取拍摄时间，没拍摄时间读取文件生成时间，无法读取文件生成时间就用当前时间。
但是，pp的骚操作又来啦！！！！
pp读取时间生成新的文件名并对文件进行重命名以后，会把这个修改操作的时间写入exif的File Modified Date。
这就导致了一个bug：对于非拍摄生成的图片，每导入一次，这张照片的File Modified Date都会被修改一次。如果恰巧又碰到了pp无法正确解析File Modified Date中保存的时间字符串，那这个文件就又会被归档到当前时间。
你可能会觉得奇怪，为什么会有傻x要把照片反复导入pp归档。
是我！是我！我就出现过这种操作！
比如我目前有8w个照片、图片、视频文件，全部导入pp进行归档，归档完成后删除了原始文件，保留了归档文件。然后很不幸我部署pp的系统崩了，但8w个已归档的文件还在。这时我重新部署一个pp，把8w个已经归档的文件又全部导入pp进行【二次归档】。
🤔🤔🤔🤔🤔🤔🤔🤔
这个时候我发现很多非拍摄生成的图片都被归档到当前时间惹！！！！！！
(╯‵□′)╯︵┻━┻
槽点四：图片算法识别功能很垃圾
pp作为一个完整的相册服务，也提供了图像算法识别功能，用来进行图像主体识别、人脸识别、自动标签、自动创建精彩时刻、图片质量打分等等智能功能。
但我实体使用下来的体验是：不好用，非常不好用。
不说和google、apple的图片算法识别比，也不和国内各个手机厂商提供的手机智能相册比，只是和immich比，我都感觉差了很多。主体识别错误、检测不到人脸、自动标签错误，很难说达到可用级别。
对于pp的图像识别算法功能，我的点评是：能用但是不好用，徒增功耗、浪费算力，建议关闭。
槽点五：免费版pp的gps解析功能有限制
相信很多pp用户和我一样都是用的免费社区版（community）做自建相册，pp免费版也带了照片地图功能，根据照片exif中保存的gps信息显示照片的拍摄地并显示在地图上。
但是，但是，pp的骚操作又又又来惹！！！
免费版pp根据gps坐标数据解析地理位置的api有请求数量限制！！！有rate limit！！！
也就是如果一次导入比较多的照片，很容易就达到这个reverse geocodeing接口的请求数量限制，这个api会直接报timeout错误让你以为是自己网络出了问题。
如果达到这个rate limit，很抱歉解析照片地理位置的功能就gg了。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ruohai.wang/202412/photoprism-complains/" /><meta property="article:section" content="202412" />
<meta property="article:published_time" content="2024-12-05T15:18:39+08:00" />
<meta property="article:modified_time" content="2024-12-05T15:18:39+08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://ruohai.wang/"><img class="app-header-avatar" src="/avatar.jpg" alt="Ruohai Wang" /></a>
      <span class="app-header-title">喵ฅ^•ﻌ•^ฅ</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">主页</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">标签</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">关于</a>
      </nav>
      <p>这种失落会持久吗~</p>
      <div class="app-header-social">
        
          <a href="https://t.me/ruohai" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">PhotoPrism缺点大吐槽：哪哪都不行，建议弃用</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Dec 5, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://ruohai.wang/tags/photoprism/">PhotoPrism</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h2 id="前言">前言</h2>
<p>先声明：从去年的7~8月份我开始折腾自建相册，当时对比了immich最后选择了photoprism，至今也用了一年半的时间了，所以算是个老用户了，不是简单新手向的吐槽。</p>
<p>为什么用了一年半以后才开始写这个吐槽文，因为我自己用java写了一个小服务来处理照片归档，所以最后一个对pp的依赖也没有了，终于可以把pp从我的服务器上remove掉惹。</p>
<p>在放弃pp的这一刻，写篇文章记录一下我在使用pp的过程中碰到的几个超级大槽点。</p>
<hr>
<h2 id="超级大槽点">超级大槽点</h2>
<blockquote>
<p>槽点一：照片统一重命名都按照UTC时区处理</p>
</blockquote>
<p>这个是pp归档照片时最大的bug。</p>
<p>pp有个功能，就是按照统一规则生成一个唯一的文件名将照片进行重命名，所以最后的文件名都是<code>yyyyMMdd_HHmmss_xxxxxxxx.jpg</code>这种格式，其中最后8位x应该是类似md5一样根据文件生成的8位字符串。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1631.jpg" alt=""></p>
<p>这个功能很好用，也是强制启用的功能。按照这个规则重命名以后的照片/视频，根据文件名就能很方便的知道文件的创建时间，而且也统一了文件名，看上去很干净规整。</p>
<p>但是这个功能有个很大的bug！！！！</p>
<p>pp是按照utc时区来生成的文件名，也就是<code>正确的照片时间需要减去8个小时</code>来生成文件名！！！</p>
<p>比如某时某刻我拍了一张jpg照片，拍摄时间是<code>2024年12月5日15点36分44秒</code>，那照片归档正确的文件名应该是<code>20241205_153644_xxxxxxxx.jpg</code>。但是pp会无视照片exif中的时区信息，而是按照utc时区生成文件名，也就是北京时间减去8个小时，最后就变成了<code>20241205_073644_xxxxxxxx.jpg</code>。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1638.jpg" alt=""></p>
<p>(╯‵□′)╯︵┻━┻</p>
<p>不过，比起原始照片文件各种乱七八糟无规则、无意义、自然递增的文件名格式，现在这个文件名只是时间少了8个小时，<code>好像</code>也不是太大的问题。</p>
<p>那就要配合上下面这个大杀器！</p>
<blockquote>
<p>槽点二：照片归档也按照UTC时区处理</p>
</blockquote>
<p>pp归档图片和视频文件时，是根据文件的创建时间，按照<code>yyyy/mm</code>的目录结构来归档文件的。</p>
<p>但这个读取文件创建时间按照utc时区处理超级大槽点，这就导致了一种情况：</p>
<ul>
<li>月初拍的照片有可能被归档到上个月！比如，2024年12月1号早上7点拍的照片，减去8小时是2024年11月30号晚上11点，就被归档到<code>2024/11</code>目录惹</li>
<li>年初拍的照片可能被归档到上一年！比如：2024年1月1日早上7点拍的照片，减去8小时候是2023年12月31日晚上11点，就被归档到<code>2023/12</code>目录惹</li>
</ul>
<p>这种情况下，如果在pp中搜索2024年12月份的照片，或者搜2024年的照片，这种错误归档的照片就搜不到了！！！</p>
<p>(╯‵□′)╯︵┻━┻</p>
<p>我在使用photoprism的这一年半时间里，也想过是不是我什么地方没设置正确，比如是不是docker-compose.yml中没有加timezone参数，是不是服务器的时间设置错误。我在官方wiki和官方github issue里也找过，但实在是个人能力有限，没有找到什么有用的解决方法。</p>
<p>但我又非常喜欢pp这个按照文件时间统一重命名、统一归档的功能，另外几个相册（比如immich）都没有这个功能，所以最后我不得不在有如此两个大槽点的情况继续坚持使用pp。</p>
<blockquote>
<p>槽点三：重命名操作会修改文件的exif</p>
</blockquote>
<p>以图片文件为例，图片的exif中，保存文件时间的大致有如下几个tag：</p>
<ul>
<li><code>Date/Time Original</code>：原始创建时间</li>
<li><code>Date/Time Digitized</code>：数字化时间</li>
<li><code>File Modified Date</code>：文件修改时间</li>
</ul>
<p>如果是<code>拍摄</code>生成的照片（手机、相机等拍摄设备），exif中都会有这几个tag，pp应该也是优先读取前两个tag进行时间解析，然后按照这个时间（别忘了会减去8小时）生成文件名。</p>
<p>但如果是<code>非拍摄</code>生成的图片（比如网上下载的图片、从微信保存的图片、各种截图），这种图片的exif中都没有前两个tag，只有<code>File Modified Date</code>保存了<code>文件生成时间</code>。对于这种图片，pp应该是读取<code>File Modified Date</code>，根据这个时间（依然要减去8个小时）生成文件名。如果读取的时间字符串无法正确解析，就会用当前时间生成文件名。</p>
<p>到这里似乎都没啥问题，有拍摄时间读取拍摄时间，没拍摄时间读取文件生成时间，无法读取文件生成时间就用当前时间。</p>
<p>但是，pp的骚操作又来啦！！！！</p>
<p>pp读取时间生成新的文件名并对文件进行重命名以后，会把这个修改操作的时间写入exif的<code>File Modified Date</code>。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1659.jpg" alt=""></p>
<p>这就导致了一个bug：对于<code>非拍摄</code>生成的图片，每导入一次，这张照片的<code>File Modified Date</code>都会被修改一次。如果恰巧又碰到了pp无法正确解析<code>File Modified Date</code>中保存的时间字符串，那这个文件就又会被归档到当前时间。</p>
<p>你可能会觉得奇怪，为什么会有傻x要把照片反复导入pp归档。</p>
<p>是我！是我！我就出现过这种操作！</p>
<p>比如我目前有8w个照片、图片、视频文件，全部导入pp进行归档，归档完成后删除了原始文件，保留了归档文件。然后很不幸我部署pp的系统崩了，但8w个已归档的文件还在。这时我重新部署一个pp，把8w个已经归档的文件又全部导入pp进行【二次归档】。</p>
<p>🤔🤔🤔🤔🤔🤔🤔🤔</p>
<p>这个时候我发现很多<code>非拍摄</code>生成的图片都被归档到当前时间惹！！！！！！</p>
<p>(╯‵□′)╯︵┻━┻</p>
<blockquote>
<p>槽点四：图片算法识别功能很垃圾</p>
</blockquote>
<p>pp作为一个完整的相册服务，也提供了图像算法识别功能，用来进行图像主体识别、人脸识别、自动标签、自动创建精彩时刻、图片质量打分等等<code>智能功能</code>。</p>
<p>但我实体使用下来的体验是：不好用，非常不好用。</p>
<p>不说和google、apple的图片算法识别比，也不和国内各个手机厂商提供的手机智能相册比，只是和immich比，我都感觉差了很多。主体识别错误、检测不到人脸、自动标签错误，很难说达到可用级别。</p>
<p>对于pp的图像识别算法功能，我的点评是：能用但是不好用，徒增功耗、浪费算力，建议关闭。</p>
<blockquote>
<p>槽点五：免费版pp的gps解析功能有限制</p>
</blockquote>
<p>相信很多pp用户和我一样都是用的免费社区版（community）做自建相册，pp免费版也带了照片地图功能，根据照片exif中保存的gps信息显示照片的拍摄地并显示在地图上。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1707.jpg" alt=""></p>
<p>但是，但是，pp的骚操作又又又来惹！！！</p>
<p>免费版pp根据gps坐标数据解析地理位置的api有请求数量限制！！！有rate limit！！！</p>
<p><img src="https://img.311803.xyz/2024/12/05/1705.jpg" alt=""></p>
<p>也就是如果一次导入比较多的照片，很容易就达到这个<code>reverse geocodeing</code>接口的请求数量限制，这个api会直接报timeout错误让你以为是自己网络出了问题。</p>
<p>如果达到这个rate limit，很抱歉解析照片地理位置的功能就gg了。</p>
<p>如果你在导入照片的时候，导到中途免费请求数用完了，会发生什么：</p>
<ol>
<li>剩下的照片依然能导入，只是剩下的照片都没有地理信息了</li>
<li>解析照片gps的请求依然会发起，只是每次都是超时无响应（timeout），这个超时要等好几秒，导致整个导入过程变成非常慢</li>
</ol>
<p>在官方wiki我没有查到明确的免费请求次数，也没有查到如果免费请求次数耗尽以后是否会隔天重置。</p>
<p>不过作为免费白嫖党，官方对此功能做出rate limit也算可以理解，因为官方提供这个服务需要开销，只是让付费用户分摊了。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1722.jpg" alt=""></p>
<p>如果你是pp重度用户，建议花钱订阅支持pp，就可以无限制使用照片地理信息解析的接口惹。</p>
<p>如果你和我一样是pp白嫖党，建议关闭pp的【地点】功能。</p>
<hr>
<h2 id="小槽点">小槽点</h2>
<blockquote>
<p>对硬件性能要求略高</p>
</blockquote>
<p>photoprism要求的最低硬件配置</p>
<ul>
<li>双核cpu</li>
<li>3GB内存</li>
<li>64位的系统</li>
<li>4GB swap</li>
</ul>
<p><img src="https://img.311803.xyz/2024/12/05/1728.jpg" alt=""></p>
<p>但我实际测试下来，在关掉所有图像算法、地理位置、webdav等等各种<code>智障</code>功能，只保留导入、归档功能的情况下，在玩客云上都能跑起来，要知道玩客云只有1GB内存 + 512MB swap。</p>
<p>不过在部署在玩客云上时，归档照片问题不大（虽然很慢，大概7秒钟处理一张照片），归档体积比较大的视频文件时很容易就oom导致服务挂掉。而且玩客云刷debian以后不支持视频解码，如果真的在玩客云上部署pp，记得千万不要在pp的web端播放本地不支持解码的视频（比如h265/av1），要不然玩客云会用它羸弱的s805芯片开始及其漫长且看不到尽头的视频转码。</p>
<p>但是，如果只是用到pp的统一重命名 + 归档功能，pp硕大的docker镜像体积（本体接近3GB，如果用pg数据库还要再加1GB的pg镜像）、至少1GB的内存占用，又显得硬件性能要求略高了。</p>
<blockquote>
<p>照片墙布局和ui不好看</p>
</blockquote>
<p>这点纯个人主观喜好，每个人审美不同要求也不同，我觉得pp的照片墙不好看，ui也显得很老气。</p>
<blockquote>
<p>搜过功能只能精确到月</p>
</blockquote>
<p>无法精确到<code>天</code>搜索文件。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1744.jpg" alt=""></p>
<blockquote>
<p>没有免费app</p>
</blockquote>
<p>官方推荐pwa，我一直用的这个，用来上传照片够用了。</p>
<p>官方也推荐了第三方的收费app：photosync，有钱的可以上。</p>
<p><img src="https://img.311803.xyz/2024/12/05/1748.jpg" alt=""></p>
<hr>
<h2 id="优点">优点</h2>
<p>不过，虽然pp的雷点这么多，小缺点也不少，但我依然坚持用了一年半，说明它比起其它自建相册服务还是有很多过人之处的：</p>
<ul>
<li>免费且稳定：免费这点打败了mtphotos，稳定这点打败了immich</li>
<li>归档功能好用：文件统一命名，解决了原始文件名乱七八糟的问题</li>
<li>老硬件友好：至今还在发布arm32硬件的docker镜像，在玩客云上跑pp成为可能</li>
</ul>
<hr>
<h2 id="结语">结语</h2>
<p>在被迫接受了pp的大雷点和小缺点并坚持使用一年半之后，我花了点时间重操旧业用java写了一个简单的照片归档程序（本来想用golang写的但年纪大了实在学不会新语言），100%符合我想要的需求：</p>
<ol>
<li>按照<code>yyyyMMdd_HHmmss_xxxxxxxx</code>格式统一文件命名（而且正确处理了时区问题哦）</li>
<li>按照<code>yyyy/mm</code>目录结构进行文件归档</li>
<li>重命名和归档操作不修改文件原始exif</li>
</ol>
<p>经过测试已经完美运行并部署到机器上惹，从此可以抛弃photoprism。</p>
<p>至于抛弃photoprism以后会用哪个相册服务？🤔</p>
<p>我对相册服务的需求其实主要就是上述的3点，对于照片在线展示并没有需求，对人脸识别、标签分类、照片地图也没有需求，所以目前用的fnos自带的相册，很好用。</p>
<p>最后还是感谢一下photoprism，感谢它陪伴了我一年半的时间。</p>
<p>🎉</p>
<hr>
<h2 id="喝杯奶茶">喝杯奶茶</h2>
<p><img src="/buy-me-a-bubble-tea.jpg" alt=""></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
