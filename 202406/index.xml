<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>202406s on å–µà¸…^â€¢ï»Œâ€¢^à¸…</title>
    <link>https://ruohai.wang/202406/</link>
    <description>Recent content in 202406s on å–µà¸…^â€¢ï»Œâ€¢^à¸…</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Wed, 05 Jun 2024 13:25:24 +0800</lastBuildDate><atom:link href="https://ruohai.wang/202406/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>åœ¨åˆ·äº†OpenWrtçš„è¿…é›·èµšé’±å®ä¸€ä»£ï¼ˆWS1408ï¼‰ä¸Šè¿è¡ŒCloudflared</title>
      <link>https://ruohai.wang/202406/cloudflared-install-on-openwrt/</link>
      <pubDate>Wed, 05 Jun 2024 13:25:24 +0800</pubDate>
      
      <guid>https://ruohai.wang/202406/cloudflared-install-on-openwrt/</guid>
      <description>ä¸Šä¸ªæœˆå·²ç»å†™è¿‡ä¸€ç¯‡åšå®¢è®°å½•æ€ä¹ˆåœ¨åˆ·äº†openwrtå›ºä»¶çš„è¿…é›·èµšé’±å®ä¸€ä»£ä¸Šé¢è¿è¡Œcloudflaredï¼Œä½†æ˜¯å†™é‚£ç¯‡æ–‡ç« çš„æ—¶å€™å¯¹sysvintçš„è„šæœ¬å®Œå…¨ä¸ç†Ÿæ‚‰ï¼Œåªæ˜¯ç…§è™ç”»çŒ«ï¼ˆç°åœ¨ä¹Ÿæ²¡æœ‰ä»€ä¹ˆè¿›æ­¥ğŸ˜‚ï¼‰ï¼Œä½†ç»è¿‡è¿™ä¸€æ®µæ—¶é—´çš„debugï¼Œå‘ç°äº†ï¼ˆçœ‹ä¸Šå»ï¼‰æ²¡ä»€ä¹ˆé—®é¢˜çš„è¿è¡Œæ–¹å¼ï¼Œæ‰€ä»¥æ›´æ–°ä¸€ä¸‹ã€‚
é¦–å…ˆè¿˜æ˜¯æ‰¾åˆ°cloudflaredçš„githubä»“åº“ä¸»é¡µã€cloudflare/cloudflaredã€‘ï¼Œåœ¨releaseé¡µé¢æ‰¾åˆ°é¢„ç¼–è¯‘çš„é€‚é…å„ç¡¬ä»¶å¹³å°çš„äºŒè¿›åˆ¶åŒ…ã€‚è¿…é›·èµšé’±å®ä¸€ä»£å¯ä»¥ç”¨armæˆ–è€…armhfï¼Œæˆ‘é€‰æ‹©ç”¨armhfã€‚
sshè¿ä¸Šopenwrtï¼Œä¸‹è½½åˆ°æœ¬åœ°
# ä¸‹è½½ wget -O cloudflared https://github.com/cloudflare/cloudflared/releases/download/2024.6.0/cloudflared-linux-armhf # æˆæƒ chmod +x cloudflared ç„¶ååœ¨/etc/init.dç›®å½•ä¸‹æ–°å»ºcloudflaredæ–‡ä»¶ï¼Œå½•å…¥ä»¥ä¸‹å†…å®¹ï¼Œæ³¨æ„æˆ‘çš„cloudflaredæ–‡ä»¶è·¯å¾„æ˜¯/mnt/data/cloudflared/cloudflaredï¼Œè¿˜æœ‰tokençš„å€¼ï¼Œéƒ½éœ€è¦ä½ æ ¹æ®è‡ªå·±çš„æƒ…å†µä¿®æ”¹ã€‚
#!/bin/sh /etc/rc.common START=99 STOP=10 SERVICE_WRITE_PID=1 SERVICE_USE_PID=1 SERVICE_DAEMONIZE=1 start() { service_start /mnt/data/cloudflared/cloudflared --pidfile /var/run/cloudflared.pid --autoupdate-freq 24h0m0s tunnel run --token [ä½ çš„token] } stop() { kill $(pidof cloudflared) } ä¿å­˜æ–‡ä»¶åé€€å‡ºï¼Œè®°å¾—chmod +x cloudflaredæˆæƒã€‚
ç„¶åå¯åŠ¨å¹¶æ·»åŠ å¼€æœºå¯åŠ¨é¡¹å³å¯ã€‚
# å¯åŠ¨ service cloudflared start # æ·»åŠ å¯åŠ¨é¡¹ service cloudflared enable æ³¨æ„æˆ‘çš„sysvinitè„šæœ¬ä¸­æ²¡æœ‰åªé€‚é…äº†startå’Œstopä¸¤ä¸ªå‘½ä»¤ï¼Œå…¶å®ƒçš„restartã€statusæ²¡æœ‰é€‚é…ï¼Œæœ‰éœ€æ±‚çš„è¯å¯ä»¥è‡ªè¡Œå¢åŠ ä»£ç ã€‚
ğŸ‰</description>
    </item>
    
  </channel>
</rss>
