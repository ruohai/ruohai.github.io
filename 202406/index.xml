<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>202406s on å–µà¸…^â€¢ï»Œâ€¢^à¸…</title>
    <link>https://ruohai.wang/202406/</link>
    <description>Recent content in 202406s on å–µà¸…^â€¢ï»Œâ€¢^à¸…</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Thu, 20 Jun 2024 12:14:28 +0800</lastBuildDate><atom:link href="https://ruohai.wang/202406/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>åœ¨Debianä¸Šå®‰è£…å’Œä½¿ç”¨V2Ray</title>
      <link>https://ruohai.wang/202406/v2ray-install-guide-on-armbian/</link>
      <pubDate>Thu, 20 Jun 2024 12:14:28 +0800</pubDate>
      
      <guid>https://ruohai.wang/202406/v2ray-install-guide-on-armbian/</guid>
      <description>æœ€è¿‘å› ä¸ºå›½å†…å½»åº•å±è”½äº†dockerhubä»¥åŠå„ç§å›½å†…é•œåƒç«™ï¼Œæ‰€ä»¥ä½¿ç”¨dockerä¹ŸæˆåŠŸåŠ å…¥äº†ç¿»å¢™å¤§ç¤¼åŒ…ã€‚æˆ‘ä¹‹å‰ä¸€ç›´ç”¨è¿‡å›½å†…çš„ä¸€äº›é•œåƒç«™ï¼Œè™½ç„¶ä¹Ÿä¸å¤ªå¥½ç”¨ä½†æˆ‘è£…çš„å®¹å™¨ä¹Ÿå°±é‚£ä¹ˆä¸¤ä¸‰ä¸ªï¼Œæ‰€ä»¥å¿ä¸€ä¸‹ä¹Ÿèƒ½ç”¨ï¼Œä½†è‡³æ­¤åªèƒ½å¦è°‹å‡ºè·¯äº†ã€‚
æˆ‘åœ¨pcä¸Šä¸€ç›´ç”¨çš„v2raynçš„å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡é…ç½®å±€åŸŸç½‘ä»£ç†è®©dockeræ­£å¯ä»¥æ­£å¸¸çš„æ‹‰å»é•œåƒ
# é¦–å…ˆæ–°å»ºç›®å½•å’Œæ–‡ä»¶ mkdir -p /etc/systemd/system/docker.service.d vim /etc/systemd/system/docker.service.d/http-proxy.conf # ç„¶ååœ¨æ–‡ä»¶ä¸­ç²˜è´´ä»¥ä¸‹å†…å®¹, æ³¨æ„ä»£ç†åœ°å€éœ€è¦æ¢æˆä½ è‡ªå·±æœåŠ¡å™¨çš„å†…ç½‘ ip å’Œä»£ç†ç«¯å£ [Service] Environment=&amp;#34;HTTP_PROXY=http://192.168.8.125:10819&amp;#34; Environment=&amp;#34;HTTPS_PROXY=http://192.168.8.125:10819&amp;#34; Environment=&amp;#34;NO_PROXY=your-registry.com,10.10.10.10,*.example.com&amp;#34; # é‡å¯ docker systemctl daemon-reload systemctl restart docker # æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆ systemctl show --property=Environment docker ä½†æˆ‘çš„pcå¹¶ä¸æ˜¯24å°æ—¶å¼€æœºï¼Œè€Œä¸”ipä¹Ÿä¸å›ºå®šï¼Œæ‰€ä»¥æƒ³ç€æŠŠv2rayéƒ¨ç½²åˆ°armå°ç›’å­ä¸Šå»ã€‚è¿™ä¸ªæ—¶å€™å¾ˆå¤šæ¡åƒåœ¾ç©å®¶å¯èƒ½å°±ç›´æ¥ä¸Šopenwrtäº†ï¼Œä½†æˆ‘ä¸æƒ³æŠ˜è…¾openwrtä¹Ÿä¸æƒ³å¢åŠ å±€åŸŸç½‘å†…çš„ç½‘ç»œå¤æ‚åº¦ï¼Œåªæ˜¯æƒ³ç®€å•éƒ¨ç½²ä¸€ä¸ªv2rayç”¨ä½œdockerçš„ä»£ç†ï¼Œå°±åƒpcç”µè„‘ä¸Šè£…ä¸€ä¸ªv2rayné‚£æ ·ã€‚
ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œæœ€åç¡®å®šä½¿ç”¨v2ray core + v2raya web uiçš„æ–¹æ¡ˆã€‚
ã€v2rayA/v2rayAã€‘é¡¹ç›®çš„å®˜æ–¹æ–‡æ¡£æä¾›äº†å¾ˆå¤šç§å®‰è£…æ–¹æ³•çš„æŒ‡å¯¼ï¼Œæˆ‘é€‰æ‹©äº†ç›´æ¥æ·»åŠ è½¯ä»¶æºã€‚
# æ·»åŠ å…¬é’¥ wget -qO - https://apt.v2raya.org/key/public-key.asc | sudo tee /etc/apt/keyrings/v2raya.asc # æ·»åŠ è½¯ä»¶æº echo &amp;#34;deb [signed-by=/etc/apt/keyrings/v2raya.asc] https://apt.v2raya.org/ v2raya main&amp;#34; | sudo tee /etc/apt/sources.list.d/v2raya.list # æ›´æ–° &amp;amp; å®‰è£… sudo apt update &amp;amp;&amp;amp; sudo apt install v2ray v2raya -y # å¯åŠ¨ &amp;amp; æ·»åŠ å¯åŠ¨é¡¹ sudo systemctl enable --now v2raya.</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨acme.shè·å–Let&#39;s Encryptå…è´¹æ•°å­—è¯ä¹¦</title>
      <link>https://ruohai.wang/202406/lets-encrypt-get-ssl-cert-by-bash/</link>
      <pubDate>Wed, 19 Jun 2024 04:09:02 +0800</pubDate>
      
      <guid>https://ruohai.wang/202406/lets-encrypt-get-ssl-cert-by-bash/</guid>
      <description>å‰è¨€ æˆ‘ä¹‹å‰ç”¨çš„sslè¯ä¹¦ä¹°é˜¿é‡Œäº‘åŸŸåé€çš„å…è´¹è¯ä¹¦ï¼Œæœ‰æ•ˆæœŸä¸€å¹´ï¼Œæœ‰æ•ˆæœŸè¿˜å‰©150å¤©ã€‚
ä½†å»å¹´åº•å¾ˆå¤šäº‘æœåŠ¡å‚å®¶è°ƒæ•´äº†è§„åˆ™ï¼Œæ–°ç”³è¯·çš„å…è´¹è¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆï¼Œç»­è´¹çš„è¯ä¸æ¸…æ¥šæ˜¯å¦ä¹Ÿæ˜¯å…è´¹ä¸‰ä¸ªæœˆï¼Œæ‰€è°“æœªé›¨ç»¸ç¼ªï¼Œæˆ‘ä¹Ÿè¦è€ƒè™‘ä¸‹å…¶å®ƒå…è´¹è¯ä¹¦çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚let&amp;rsquo;s encryptã€‚
ç”³è¯·let&amp;rsquo;s encryptè¯ä¹¦ï¼Œå®˜æ–¹é»˜è®¤æ¨ècertbotçš„è¿›è¡Œè¯ä¹¦çš„è‡ªåŠ¨ç”³è¯·ã€å®‰è£…ï¼Œä½†ä½¿ç”¨certbotéœ€è¦å®‰è£…snapdï¼Œè¿™ä¸ªæ–¹æ³•è·³è¿‡ã€‚
æœ€åæˆ‘é€‰æ‹©äº†acme.shï¼Œå› ä¸ºç½‘ä¸Šå¯ä»¥å‚è€ƒçš„æ–¹æ¡ˆæ¯”è¾ƒå¤šï¼Œå‡ºé—®é¢˜æ¯”è¾ƒå®¹æ˜“debugã€‚
å‚è€ƒæ–‡ç«  ç”¨acme.shå®Œæˆlet&amp;rsquo;s encryptæ•°å­—è¯ä¹¦çš„ç”³è¯·ã€éªŒè¯ã€å®‰è£…ï¼Œç½‘ä¸Šå·²ç»æœ‰éå¸¸å®Œå–„çš„æ•™ç¨‹ï¼Œæˆ‘å‚è€ƒçš„ä¸»è¦æ˜¯è¿™å‡ ç¯‡ï¼š
ã€acmesh-official/acme.shã€‘ ã€How to installã€‘ ã€å¦‚ä½•ä½¿ç”¨acme.shä¸é˜¿é‡Œäº‘DNSè‡ªåŠ¨ç­¾å‘Letâ€™s Encryptçš„å…è´¹æ•°å­—è¯ä¹¦ã€‘ åŸºæœ¬ä¸ŠæŒ‰ç…§ä»¥ä¸Šä¸‰ç¯‡æ–‡ç« ä¸­è®°å½•çš„æ­¥éª¤æ“ä½œï¼Œå°±å¯ä»¥æˆåŠŸæå®šã€‚
æˆ‘ç¢°åˆ°çš„ä¸€äº›å‘ ç½‘ä¸Šçš„æ•™ç¨‹æ–‡ç« è™½ç„¶å¾ˆå®Œå–„ï¼Œä½†æˆ‘åœ¨å®é™…éƒ¨ç½²çš„è¿‡ç¨‹ä¸­è¿˜æ˜¯ç¢°åˆ°äº†ä¸€äº›bugï¼Œè¿™æ˜¯æˆ‘å†™è¿™ç¯‡åšå®¢çš„ä¸»è¦åŸå› ï¼Œåšä¸ªè®°å½•ï¼Œæ–¹ä¾¿æ—¥ådebugã€‚
é—®é¢˜ä¸€ï¼šä¸­å›½ç‰¹è‰²çš„ç½‘ç»œé—®é¢˜
åœ¨ç¬¬ä¸€æ­¥è·å–acme.shè„šæœ¬çš„æ—¶å€™å°±ç¢°åˆ°äº†é—®é¢˜ï¼Œä¸­å›½ç‰¹è‰²çš„ç½‘ç»œé—®é¢˜ï¼Œæ— è®ºæ˜¯é»˜è®¤çš„https://get.acme.shè¿˜æ˜¯å¤‡ç”¨çš„https://raw.githubusercontent.com/acmesh-official/acme.sh/master/acme.shéƒ½æç¤ºæ— æ³•è¿æ¥ã€‚
è¿™åªæ˜¯ä¸ªå°é—®é¢˜ï¼Œè‡ªè¡Œè§£å†³å³å¯ã€‚
ä¹Ÿå¯ä»¥åœ¨æœ‰ä»£ç†çš„ç”µè„‘ä¸Šè®¿é—®ä»¥ä¸Šé“¾æ¥ï¼Œä¸‹è½½è„šæœ¬ä»¥åç”¨scpä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œè®°å¾—chmod +x acme.shæˆæƒï¼Œç„¶åç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œè„šæœ¬
./acme.sh --install -m my@example.com æ‰§è¡Œå®Œæˆåè®°å¾—æ•²source .bashrcå‘½ä»¤è®©æ–°å»ºçš„aliasç”Ÿæ•ˆã€‚
é—®é¢˜äºŒï¼šéªŒè¯æ–¹å¼
éªŒè¯æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œhttpæˆ–è€…dnsã€‚
httpæ–¹å¼éœ€è¦æŒ‡å®šç½‘ç«™æ ¹ç›®å½•ï¼Œæˆ‘å› ä¸ºæ˜¯ç”¨äº†ä¸€ä¸ªè·³æ¿æœºï¼ˆnginxè½¬å‘è¯·æ±‚åˆ°å¦ä¸€ä¸ªæœºå™¨ï¼‰ï¼Œç½‘ç«™å’Œnginxå¹¶ä¸æ˜¯åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œå°è¯•äº†è®¸ä¹…éƒ½æ²¡æœ‰ç”¨httpæ–¹å¼éªŒè¯æˆåŠŸã€‚
åæ¥æ¢ç”¨dnséªŒè¯ï¼Œæˆ‘çš„dnsæœåŠ¡å™¨ä¸Šæ˜¯aliyunï¼Œåœ¨è·å–åˆ°aliyunçš„access keyå¹¶é…ç½®ä»¥åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤
acme.sh --issue --dns dns_ali -d ruohai.wang -d *.ruohai.wang è¿™ä¸ªæ—¶å€™æˆ‘åˆç¢°åˆ°äº†æŠ¥é”™ï¼šcan not find dns api hook for dns_ali
è¿™ä¸ªæŠ¥é”™è¦ä¸´æ—¶è§£å†³çš„è¯å€’ä¹Ÿç®€å•ï¼Œçº¢å­—æé†’éƒ¨åˆ†å·²ç»ç»™å‡ºäº†æ–¹æ¡ˆï¼Œå°±æ˜¯è‡ªå·±æ‰‹åŠ¨å¢åŠ ä¸¤ä¸ªdnsè§£æè®°å½•å°±è¡Œäº†ã€‚
éªŒè¯æˆåŠŸä»¥åï¼Œç”³è¯·è¯ä¹¦çš„æµç¨‹å°±å¯ä»¥è·‘å®Œäº†ï¼Œæœ€åæˆåŠŸçš„æç¤ºå†…å®¹å¦‚ä¸‹ï¼š
é—®é¢˜ä¸‰ï¼šè¯ä¹¦é…ç½®
æˆ‘ç”¨çš„webæœåŠ¡å™¨æ˜¯nginxï¼Œæˆ‘ä»¬è¦ç”¨çš„è¯ä¹¦æ–‡ä»¶æ˜¯å°±æ˜¯å‰ä¸¤ä¸ªï¼Œfullchain.cerå’Œruohai.wang.keyã€‚å¯ä»¥åœ¨nginxç›®å½•ä¸‹æ–°å»ºç›®å½•æ”¾è¿™ä¿©è¯ä¹¦ã€‚
ç›´æ¥è´´å‡ºé…ç½®æ–‡ä»¶å§ï¼ˆåªä¿ç•™äº†sslæœ‰å…³çš„éƒ¨åˆ†ï¼‰
server { listen 443 ssl; server_name ruohai.wang; ssl_certificate /path/to/fullchain.cer; ssl_certificate_key /path/to/ruohai.wang.key; ssl_session_cache shared:SSL:1m; ssl_session_timeout 5m; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!</description>
    </item>
    
    <item>
      <title>Uptime Kumaå¼‚å¸¸æŠ¥é”™getaddrinfo EAI_AGAINçš„å¤„ç†</title>
      <link>https://ruohai.wang/202406/uptime-kuma-error-solve/</link>
      <pubDate>Tue, 18 Jun 2024 20:11:35 +0800</pubDate>
      
      <guid>https://ruohai.wang/202406/uptime-kuma-error-solve/</guid>
      <description>å¥½å‡ æ¬¡æƒ³åœ¨è‡ªå·±çš„å°ä¸»æœºä¸Šç”¨dockeæ–¹å¼éƒ¨ç½²uptime kumaæ¥æ£€æµ‹è‡ªå·±éƒ¨ç½²çš„å‡ ä¸ªæœåŠ¡çš„å¯ç”¨çŠ¶æ€ï¼Œä½†å‡ ä¹æ¯æ¬¡éƒ½ç¢°åˆ°åŒä¸€ä¸ªé—®é¢˜ï¼šgetaddrinfo EAI_AGAINã€‚
ç½‘ä¸Šä¹Ÿæœäº†å¥½ä¹…çš„é”™è¯¯åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼Œæœ‰å¾—è¯´ç½‘ç»œé—®é¢˜ï¼Œæœ‰çš„è¯´dnsè§£æé—®é¢˜ã€‚æˆ‘ä¹Ÿåœ¨é¡¹ç›®çš„githubä»“åº“æŸ¥çœ‹äº†å¤§é‡çš„ç±»ä¼¼issuesï¼Œä½†éƒ½æ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚
æˆ‘è§‰å¾—å¯èƒ½æ˜¯æˆ‘æ£€æµ‹çš„å‡ ä¸ªæœåŠ¡éƒ½æ˜¯å¥—äº†cloudflare tunnelçš„ç¼˜æ•…ï¼Œä½†å®æµ‹æ£€æµ‹baidu.comè¿™ä¸ªåŸŸåä¹Ÿä¼šæŠ¥åŒæ ·çš„é”™è¯¯ã€‚
å› ä¸ºä¸€ç›´æ²¡æœ‰debugçš„æ€è·¯ï¼Œæ‰€ä»¥æˆ‘å°±æ”¾å¼ƒäº†uptime kumaã€‚
ä½†æ˜¯ä»Šå¤©å†™è¿™ç¯‡æ–‡ç« ï¼Œå°±æ˜¯å› ä¸ºæˆ‘çŸ¥é“è¿™ä¸ªæŠ¥é”™çš„åŸå› äº†ï¼
å…ˆè¯´ä¸€ä¸‹æˆ‘çš„éƒ¨ç½²æ–¹å¼ï¼šx86_64å¹³å°çš„debianï¼Œé˜²ç«å¢™ufwï¼Œdocker-composeæ–¹å¼éƒ¨ç½²ï¼Œnetwork_modeæ–¹å¼æ˜¯é»˜è®¤çš„bridgeã€‚
å‡ºç°getaddrinfo EAI_AGAINçš„åŸå› å°±æ˜¯dockeré»˜è®¤éƒ¨ç½²çš„åº”ç”¨éƒ½æ˜¯network_mode:bridgeï¼Œæ”¹æˆhostæ¨¡å¼å°±æ²¡é—®é¢˜äº†ã€‚
ä¸è¿‡æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œnetwork_modeæ”¹æˆhostæ¨¡å¼ä»¥åå°±ä¸æ”¯æŒç«¯å£æ˜ å°„äº†ï¼Œé»˜è®¤æ˜¯3001ç«¯å£ï¼Œå¦‚æœè£…äº†é˜²ç«å¢™çš„è¯è®°å¾—æ”¾è¡Œç«¯å£å·ã€‚</description>
    </item>
    
    <item>
      <title>åœ¨åˆ·äº†OpenWrtçš„è¿…é›·èµšé’±å®ä¸€ä»£ï¼ˆWS1408ï¼‰ä¸Šè¿è¡ŒCloudflared</title>
      <link>https://ruohai.wang/202406/cloudflared-install-on-openwrt/</link>
      <pubDate>Wed, 05 Jun 2024 13:25:24 +0800</pubDate>
      
      <guid>https://ruohai.wang/202406/cloudflared-install-on-openwrt/</guid>
      <description>ä¸Šä¸ªæœˆå·²ç»å†™è¿‡ä¸€ç¯‡åšå®¢è®°å½•æ€ä¹ˆåœ¨åˆ·äº†openwrtå›ºä»¶çš„è¿…é›·èµšé’±å®ä¸€ä»£ä¸Šé¢è¿è¡Œcloudflaredï¼Œä½†æ˜¯å†™é‚£ç¯‡æ–‡ç« çš„æ—¶å€™å¯¹sysvintçš„è„šæœ¬å®Œå…¨ä¸ç†Ÿæ‚‰ï¼Œåªæ˜¯ç…§è™ç”»çŒ«ï¼ˆç°åœ¨ä¹Ÿæ²¡æœ‰ä»€ä¹ˆè¿›æ­¥ğŸ˜‚ï¼‰ï¼Œä½†ç»è¿‡è¿™ä¸€æ®µæ—¶é—´çš„debugï¼Œå‘ç°äº†ï¼ˆçœ‹ä¸Šå»ï¼‰æ²¡ä»€ä¹ˆé—®é¢˜çš„è¿è¡Œæ–¹å¼ï¼Œæ‰€ä»¥æ›´æ–°ä¸€ä¸‹ã€‚
é¦–å…ˆè¿˜æ˜¯æ‰¾åˆ°cloudflaredçš„githubä»“åº“ä¸»é¡µã€cloudflare/cloudflaredã€‘ï¼Œåœ¨releaseé¡µé¢æ‰¾åˆ°é¢„ç¼–è¯‘çš„é€‚é…å„ç¡¬ä»¶å¹³å°çš„äºŒè¿›åˆ¶åŒ…ã€‚è¿…é›·èµšé’±å®ä¸€ä»£å¯ä»¥ç”¨armæˆ–è€…armhfï¼Œæˆ‘é€‰æ‹©ç”¨armhfã€‚
sshè¿ä¸Šopenwrtï¼Œä¸‹è½½åˆ°æœ¬åœ°
# ä¸‹è½½ wget -O cloudflared https://github.com/cloudflare/cloudflared/releases/download/2024.6.0/cloudflared-linux-armhf # æˆæƒ chmod +x cloudflared ç„¶ååœ¨/etc/init.dç›®å½•ä¸‹æ–°å»ºcloudflaredæ–‡ä»¶ï¼Œå½•å…¥ä»¥ä¸‹å†…å®¹ï¼Œæ³¨æ„æˆ‘çš„cloudflaredæ–‡ä»¶è·¯å¾„æ˜¯/mnt/data/cloudflared/cloudflaredï¼Œè¿˜æœ‰tokençš„å€¼ï¼Œéƒ½éœ€è¦ä½ æ ¹æ®è‡ªå·±çš„æƒ…å†µä¿®æ”¹ã€‚
#!/bin/sh /etc/rc.common START=99 STOP=10 SERVICE_WRITE_PID=1 SERVICE_USE_PID=1 SERVICE_DAEMONIZE=1 start() { service_start /mnt/data/cloudflared/cloudflared --pidfile /var/run/cloudflared.pid --autoupdate-freq 24h0m0s tunnel run --token [ä½ çš„token] } stop() { kill $(pidof cloudflared) } ä¿å­˜æ–‡ä»¶åé€€å‡ºï¼Œè®°å¾—chmod +x cloudflaredæˆæƒã€‚
ç„¶åå¯åŠ¨å¹¶æ·»åŠ å¼€æœºå¯åŠ¨é¡¹å³å¯ã€‚
# å¯åŠ¨ service cloudflared start # æ·»åŠ å¯åŠ¨é¡¹ service cloudflared enable æ³¨æ„æˆ‘çš„sysvinitè„šæœ¬ä¸­æ²¡æœ‰åªé€‚é…äº†startå’Œstopä¸¤ä¸ªå‘½ä»¤ï¼Œå…¶å®ƒçš„restartã€statusæ²¡æœ‰é€‚é…ï¼Œæœ‰éœ€æ±‚çš„è¯å¯ä»¥è‡ªè¡Œå¢åŠ ä»£ç ã€‚
ğŸ‰</description>
    </item>
    
  </channel>
</rss>
