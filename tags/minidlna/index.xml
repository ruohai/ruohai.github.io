<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>MiniDLNA on 喵ฅ^•ﻌ•^ฅ</title>
    <link>https://ruohai.wang/tags/minidlna/</link>
    <description>Recent content in MiniDLNA on 喵ฅ^•ﻌ•^ฅ</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sat, 30 Mar 2024 06:02:16 +0800</lastBuildDate><atom:link href="https://ruohai.wang/tags/minidlna/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>在玩客云上安装&amp;配置MiniDLNA</title>
      <link>https://ruohai.wang/202403/minidlna-config-on-onecloud/</link>
      <pubDate>Sat, 30 Mar 2024 06:02:16 +0800</pubDate>
      
      <guid>https://ruohai.wang/202403/minidlna-config-on-onecloud/</guid>
      <description>前言 在看海纳思官方页面的一些功能介绍的时候发现了minidlna。之前我都是直接用的samba，对dlna协议还真没试过，这次正好了解下。
实际在配置的过程中碰到了不少问题，比如扫描不到媒体目录下的文件，花了一些时间debug，这里做一些记录。
安装 玩客云刷的是armbian系统，安装minidlna很简单，一条命令。
sudo apt install minidlna 需要注意minidlna服务需要安装的包会比较多，大概占用100~300MB的存储空间。玩客云的内置存储空间不多，请合理规划。
配置 先列一下minidlna的三个配置文件：
/etc/minidlna.conf /etc/defalut/minidlna.conf /lib/systemd/system/minidlna.service 再说一下要改的配置，以下各配置项修改后需要重启minidlna后生效。
媒体文件目录
修改/etc/minidlna.conf，把media_dir=/var/lib/minidlna调整为自己存放媒体文件的目录
默认端口
修改/etc/minidlna.conf，找到port=8200，可以用默认端口，也可以根据自己的喜好调整。如果有安装ufw或者firewalld，记得放行端口。
默认用户/组
默认用户:组都是minidlna，会碰到一些目录读取的权限问题。图方便的话可以直接chmod 777，或者修改/lib/systemd/system/minidlna.service，调整User=minidlna和Group=minidlna两项，想省事可以可以都用root账户。
如果改成其它用户/组，修改以后注意一起修改/var/cache/minidlna目录的权限。
max_user_watches
改完上面这些以后，启动minidlna依然会报错，查看/var/log/minidlna下的日志，发现有报错信息
monitor.c:222: warn: WARNING: Inotify max_user_watches [8638] is low or close to the number of used watches [2] and I do not have permission to increase this limit. Please do so manually by writing a higher value into /proc/sys/fs/inotify/max_user_watches. 意识是默认设置的程序可监控的文件数量8638个太少了，程序无法运行，需要把这个值改的大一些
修改方法
sudo sysctl -w fs.inotify.max_user_watches=524288 到这一步，minidlna重新载入配置然后重启即可。</description>
    </item>
    
  </channel>
</rss>
