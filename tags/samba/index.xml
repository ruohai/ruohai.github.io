<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Samba on å–µà¸…^â€¢ï»Œâ€¢^à¸…</title>
    <link>https://ruohai.wang/tags/samba/</link>
    <description>Recent content in Samba on å–µà¸…^â€¢ï»Œâ€¢^à¸…</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Wed, 02 Aug 2023 22:35:07 +0800</lastBuildDate><atom:link href="https://ruohai.wang/tags/samba/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>è¿…é›·èµšé’±å®ä¸€ä»£ï¼ˆWS1408ï¼‰åœ¨OpenWrtå›ºä»¶åŸºç¡€ä¸Šå®‰è£…å’Œé…ç½®Samba</title>
      <link>https://ruohai.wang/202308/ws1408-samba-use-guide/</link>
      <pubDate>Wed, 02 Aug 2023 22:35:07 +0800</pubDate>
      
      <guid>https://ruohai.wang/202308/ws1408-samba-use-guide/</guid>
      <description>å‰è¨€ ws1408åªæœ‰ä¸€ç‰ˆopenwrtå›ºä»¶ï¼Œè¦åœ¨openwrtçš„åŸºç¡€ä¸Šå®‰è£…sambaï¼Œå’Œarmbianæœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œè¿™é‡Œåšç®€å•è®°å½•ã€‚
å…¶å®åœ¨oenwrtçš„webuiä¸Šä¹Ÿæœ‰å…¥å£å¯ä»¥å®‰è£…è½¯ä»¶å’Œé…ç½®ï¼Œä½†æˆ‘å®é™…ç”¨ä¸‹æ¥æ€»æ˜¯ä¼šæœ‰å„ç§é—®é¢˜ã€‚æ‰€ä»¥æœ€åæ”¾å¼ƒäº†webuiå®‰è£…å’Œé…ç½®çš„æ–¹æ³•ï¼Œç›´æ¥æ‰‹æ“ã€‚çœŸçš„ï¼Œè‡ªå·±æ‰‹æ“æ¯”webuiä¸Šå‹¾å‹¾ç‚¹ç‚¹æˆåŠŸç‡é«˜å¤šäº†ã€‚
è¦å®‰è£…è½¯ä»¶ï¼Œè®°å¾—å…ˆæ¢æºï¼ŒæŒ‡è·¯ï¼šè¿…é›·èµšé’±å®ä¸€ä»£ï¼ˆWS1408ï¼‰çš„OpenWrtå¯ç”¨æºåˆ†äº«
å®‰è£…samba å…ˆæ›´æ–°è½¯ä»¶ä»“åº“
opkg update æŸ¥æ‰¾è½¯ä»¶
opkg list | grep samba å®‰è£…è½¯ä»¶
opkg install luci-app-samba4 æ·»åŠ ç³»ç»Ÿç”¨æˆ· ws1408çš„openwrtå›ºä»¶æ¯”è¾ƒç²¾ç®€ï¼Œé»˜è®¤åªæœ‰rootè´¦æˆ·ï¼Œæƒ³æ–°å¢ç³»ç»Ÿç”¨æˆ·éœ€è¦å®‰è£…useraddã€‚
opkg install shadow-useradd æ·»åŠ ç”¨æˆ·jackã€‚è¿™é‡ŒæŒ‡å®šjackè¿™ä¸ªç”¨æˆ·æ— æ³•ç™»å½•ï¼Œå› ä¸ºåªæ˜¯ç”¨æ¥åšsambaçš„ç”¨æˆ·ï¼Œä¸ä¼šç™»å½•ç³»ç»Ÿã€‚
useradd jack -s /bin/false å¦‚æœjackè¿™ä¸ªç”¨æˆ·éœ€è¦ç™»å½•ç³»ç»Ÿï¼Œé‚£ä¸Šé¢çš„å‘½ä»¤ä¸­å»æ‰-s /bin/falseï¼Œç„¶åç»™ä»–è®¾ç½®å¯†ç 
passwd jack sambaä¸­æ·»åŠ ç”¨æˆ· æ·»åŠ äº†ç³»ç»Ÿç”¨æˆ·ä»¥åï¼Œéœ€è¦åœ¨sambaä¸­æ·»åŠ ç”¨æˆ·ã€‚ä¸‹é¢è¿™æ¡å‘½ä»¤æ•²å®Œåå›è½¦ï¼Œæ ¹æ®ç³»ç»Ÿä¼šæç¤ºè®¾ç½®å¯†ç 
smbpasswd -a jack å¦‚æœæƒ³è¦åˆ é™¤sambaç”¨æˆ·ï¼Œå‘½ä»¤åº”è¯¥å¦‚ä¸‹
smbpasswd -x jack ä½†æˆ‘å®é™…ä½¿ç”¨ä¸‹æ¥ï¼Œè¿™æ¡åˆ é™¤ç”¨æˆ·çš„å‘½ä»¤ä¼šä¸€ç›´æç¤ºå¤„ç†å¤±è´¥ã€‚æ‰€ä»¥æœ‰æ•ˆçš„åŠæ³•æ˜¯ç”¨nanoæ‰“å¼€/etc/samba/smbpasswdè¿™ä¸ªä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„æ–‡ä»¶ï¼Œåˆ é™¤æˆ–è€…æ¸…ç©ºé‡Œé¢çš„å†…å®¹ã€‚
é…ç½®å…±äº«æ–‡ä»¶å¤¹ sambaé…ç½®æ–‡ä»¶çš„è·¯å¾„æ˜¯/etc/samba/smb.confï¼Œä½†é»˜è®¤çš„è¿™ä¸ªsmb.confé…ç½®æ–‡ä»¶åªæ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼Œå®é™…æŒ‡å‘äº†/var/etc/smb.confã€‚æˆ‘å°è¯•ç›´æ¥ä¿®æ”¹è¿™ä¸ªè½¯é“¾æ¥ç‰ˆçš„smb.confæ–‡ä»¶ï¼Œä½†æ¯æ¬¡ä¸€é‡å¯sambaæœåŠ¡å°±ä¼šè¢«é‡ç½®ã€‚é‚£æ­£å¥½ï¼ŒåŸå§‹æ–‡ä»¶ä¸åŠ¨ï¼Œå’±å¦ç«‹é—¨æˆ·ã€‚
# è¿›ç›®å½• cd /etc/samba # æŠŠåŸæ–‡ä»¶é‡å‘½å mv smb.conf smb.conf.default # æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ touch smb.conf ç„¶åç”¨nanoç¼–è¾‘smb.confï¼Œå¡«å†™ä»¥ä¸‹å†…å®¹ã€‚å› ä¸ºæˆ‘å¯¹sambaå…±äº«çš„å®‰å…¨æ€§è¦æ±‚ç•¥é«˜ï¼Œæ‰€ä»¥é™å®šsmbæœ€ä½ç‰ˆæœ¬æ˜¯smb2ï¼Œé™å®šåªæœ‰jackå¯ä»¥è®¿é—®ï¼Œè€Œä¸”ç¦æ­¢åŒ¿åè®¿é—®ã€‚
#======================= Global Setting ======================= [global] workgroup = WORKGROUP security = user server role = standalone server map to guest = never server min protocol = SMB2 #======================= Share Definitions ======================= [ShareFolder] comment = share comment path = /path/to/folder create mask = 0755 directory mask = 0755 valid users = jack browseable = yes writable = yes read only = no public = no guest ok = no å®Œæˆä»¥ä¸Šçš„é…ç½®ä»¥åï¼Œé‡å¯sambaã€‚</description>
    </item>
    
    <item>
      <title>Linuxä¸‹CIFSè®¾ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½smbå…±äº«æ–‡ä»¶å¤¹</title>
      <link>https://ruohai.wang/202307/cifs-auto-mount-at-linux-start-up/</link>
      <pubDate>Fri, 21 Jul 2023 00:37:06 +0800</pubDate>
      
      <guid>https://ruohai.wang/202307/cifs-auto-mount-at-linux-start-up/</guid>
      <description>å‰è¨€ å‰ä¸¤å¤©å†™è¿‡ä¸€ç¯‡ç”¨cifsæŒ‚è½½smbå…±äº«æ–‡ä»¶å¤¹çš„æ–‡ç« ï¼Œä½†é‚£ç¯‡æ–‡ç« ä¸­å¤šæœ‰ç–æ¼ï¼Œæœ¬æ¥ç›´æ¥åœ¨é‚£ç¯‡æ–‡ç« ä¸­updateè¡¥æ¼ä¿®æ­£å°±è¡Œï¼Œä½†æœ€è¿‘æ‡’äº†ï¼Œç›´æ¥æ‹©é‡ç‚¹é‡å†™ä¸€ç¯‡ã€‚
linuxæŒ‚è½½smbå…±äº«æ–‡ä»¶å¤¹æ¶‰åŠåˆ°å¾ˆå¤šæƒé™åˆ†é…çš„è®¾ç½®ï¼Œæ¯”å¦‚smbæœåŠ¡ç«¯è®¾ç½®çš„ç”¨æˆ·å’Œç»„ã€æœ¬åœ°åˆ†é…çš„ç”¨æˆ·å’Œç»„ã€æ˜¯ä¸æ˜¯æŒ‡å®šæ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„é»˜è®¤æƒé™ã€‚å¦‚æœå®åœ¨æä¸æ¸…ï¼Œé‚£å°±ç›´æ¥root:rootå’Œ0777ä¸€æŠŠæ¢­ï¼Œä½†åƒä¸‡è€Œä¸”ä¸€å®šè¦æ„è¯†åˆ°rootå’Œ0777çš„æ½œåœ¨é£é™©ã€‚
è®¾å®š æ³¨æ„ä¸‹é¢å‡ºç°çš„é…ç½®æ–‡ä»¶ä¸­çš„ipåœ°å€ã€ç”¨æˆ·åã€ç»„åã€å¯†ç éƒ½è¦æ ¹æ®è‡ªå·±çš„æƒ…å†µåšä¿®æ”¹ã€‚ğŸ˜„
è®¾å®šæœ¬åœ°ç”¨æˆ·éƒ½æ˜¯jackï¼Œæ‰€å±çš„ç»„æ˜¯jack-group è®¾å®šçš„smbå…±äº«æ–‡ä»¶å¤¹çš„è®¿é—®åœ°å€æ˜¯//192.168.1.1/shareï¼Œè®¿é—®ç”¨æˆ·smbï¼Œè®¿é—®å¯†ç 123456 è®¾å®šæœ¬åœ°æŒ‚è½½smbå…±äº«æ–‡ä»¶å¤¹çš„è·¯å¾„æ˜¯/mnt/share æŒ‚è½½ linuxä¸‹å®‰è£…cifs-utilsåï¼ŒæŒ‚è½½å±€åŸŸç½‘smbå…±äº«æ–‡ä»¶å¤¹ï¼Œæ³¨æ„-oå‚æ•°ä¸­åˆ«å¿˜è®°åŠ ä¸Šiocharset=utf8ä»¥é¿å…ä¸­æ–‡ä¹±ç çš„é—®é¢˜ã€‚
mount -t cifs //192.168.1.1/share /mnt/share -o username=smb,password=123456,iocharset=utf8 å–æ¶ˆæŒ‚è½½
umount /mnt/share å¼€æœºè‡ªåŠ¨æŒ‚è½½ ç¼–è¾‘/etc/fstabæ–‡ä»¶ï¼Œæ·»åŠ ä¸€è¡Œï¼š
//192.168.1.1/share /mnt/share cifs credentials=/home/jack/.cifs_creds,file_mode=0755,dir_mode=0755,iocharset=utf8,uid=jack,gid=jack&amp;#39;s_group 0 0 æ³¨æ„ï¼š
smbè®¿é—®è´¦æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå»ºè®®å•ç‹¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶æ¥ä¿å­˜è€Œä¸æ˜¯æ˜æ–‡å†™åœ¨fstabã€‚æˆ‘è¿™é‡Œæ–°å»º/home/jack/.cifs_credsã€‚è®¤è¯æ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼š username=smb password=123456 # ä¸‹é¢è¿™ä¸€æ å¯ä»¥ä¸è¦ domain=WORKGROUP domainä¸€æ å¯é€‰ï¼Œä¸å¡«çš„è¯ç³»ç»Ÿä¼šè‡ªåŠ¨çŒœï¼ˆæ„å‘³ç€çŒœä¸ä¸­å°±æ— æ³•æŒ‚è½½ï¼‰ï¼Œä¸€èˆ¬é»˜è®¤éƒ½æ˜¯WORKGROUP uid=jack,gid=jack&#39;s_groupï¼Œè¿™æ˜¯æŒ‡å®šæŒ‚è½½çš„smbå…±äº«æ–‡ä»¶å¤¹çš„æœ¬åœ°ç”¨æˆ·å’Œç»„åˆ†é…ç»™è°ã€ç»™å“ªä¸ªç»„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šuidå’Œgidï¼Œé»˜è®¤å°±æ˜¯root:rootã€‚ file_mode=0755,dir_mode=0755ï¼Œè¿™ä¿©å¾ˆå¥½ç†è§£ï¼Œæ–‡ä»¶çš„æƒé™å’Œæ–‡ä»¶å¤¹çš„æƒé™ï¼Œ0755ä»€ä¹ˆæ„æ€ä¸å†èµ˜è¿°ï¼Œä¸æ‡‚å¾—è¯0777ä¸€æŠŠæ¢­ã€‚ iocharset=utf8ç”¨æ¥å¤„ç†ä¸­æ–‡ä¹±ç é—®é¢˜ ç¼–è¾‘å®Œ/etc/fstabï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä½¿é…ç½®ç”Ÿæ•ˆï¼š
# é‡è½½ systemctl daemon-reload # é‡æ–°æŒ‚è½½ mount -a OKï¼Œå¤§åŠŸå‘Šæˆ~
ğŸ˜„</description>
    </item>
    
    <item>
      <title>Linuxä¸‹å®‰è£…SambaæœåŠ¡å¼€å¯æ–‡ä»¶å¤¹å…±äº«åŠŸèƒ½</title>
      <link>https://ruohai.wang/202307/samba-setup-to-share-files/</link>
      <pubDate>Sun, 16 Jul 2023 13:15:51 +0800</pubDate>
      
      <guid>https://ruohai.wang/202307/samba-setup-to-share-files/</guid>
      <description>å‰è¨€ å±€åŸŸç½‘å¦‚æœé‡Œæœ‰ä¸€å°24å°æ—¶å¼€æœºçš„ä½åŠŸè€—linuxä¸»æœºï¼Œé‚£è‡ªç„¶æ˜¯è¦ç»™å®ƒè£…ä¸Šsambaå¼€å¯æ–‡ä»¶å…±äº«åŠŸèƒ½ï¼ŒæŠŠå®ƒä½œä¸ºä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨æ¥ç”¨ã€‚å¯èƒ½æœ‰äººä¼šé—®ï¼Œæƒ³å¼€å…±äº«æ–‡ä»¶å¤¹ï¼Œç›´æ¥ç»™ä¸»æœºè£…casaosä¸å°±å¥½äº†ï¼Œå°±ç®—ä¸ç”¨sambaä¹Ÿå¯ä»¥ç”¨filebrowserã€alistã€dufsã€chfsä¹‹ç±»ã€‚emmmï¼Œè¯´çš„å¾ˆå¯¹ï¼Œä½†é‚£ä¸æ˜¯å°‘äº†å¾ˆå¤šæ‰‹åŠ¨æŒ¡çš„ä¹è¶£å˜›ã€‚è€Œä¸”è‡ªå·±æ‰‹æ“ä¸€è¾¹ï¼Œä¹Ÿæ–¹ä¾¿æ›´å¥½çš„ç†è§£sambaã€‚
åœ¨è®°å½•å®‰è£…å’Œé…ç½®çš„å†…å®¹æ—¶ï¼Œç¡®å®ä¼šå‘ç°å¾ˆå¤šç»†èŠ‚æ²¡æ³•å…·ä½“ä¸€ä¸€è®°å½•ï¼Œåªèƒ½è®°å½•ä¸‹ç¬¦åˆæˆ‘çš„éœ€æ±‚çš„é…ç½®ã€‚è¿™æ—¶å€™å°±ä¼šè§‰å¾—ç±»ä¼¼casaosè¿™ç§webuiä¸Šç›´æ¥é¼ æ ‡ç‚¹ç‚¹å°±å¼€å¯å…±äº«çš„æ–¹å¼æ–¹ä¾¿å¤šäº†ã€‚
å‰æœŸå‡†å¤‡ ä¸€å°24å°æ—¶å¼€æœºçš„ä½åŠŸè€—linuxä¸»æœºï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯èµšé’±å®äºŒä»£ï¼ˆws1508ï¼‰ linuxç³»ç»Ÿæœ‰ä¸€ä¸ªérootçš„ä½æƒé™è´¦æˆ·ï¼Œè¿™é‡Œå‡å®šï¼šjack å¦‚æœç³»ç»Ÿå®‰è£…äº†é˜²ç«å¢™ï¼Œè®°å¾—æ”¾è¡ŒsambaæœåŠ¡ sambaçš„å®‰è£… debianä»“åº“é‡Œå°±æœ‰sambaï¼Œç›´æ¥ä¸€é”®å®‰è£…
apt install samba å®‰è£…å®Œæˆåï¼Œå¯ä»¥æ‰§è¡Œsystemctl status smbdçœ‹ä¸‹æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ã€‚
â— smbd.service - Samba SMB Daemon Loaded: loaded (/lib/systemd/system/smbd.service; enabled; preset: enabled) Active: active (running) since Sun 2023-07-16 13:44:59 CST; 11min ago Docs: man:smbd(8) man:samba(7) man:smb.conf(5) Process: 4040 ExecCondition=/usr/share/samba/is-configured smb (code=exited, status=0/SUCCESS) Process: 4043 ExecStartPre=/usr/share/samba/update-apparmor-samba-profile (code=exited, status=0/SUCCESS) Main PID: 4044 (smbd) Status: &amp;#34;smbd: ready to serve connections...&amp;#34; Tasks: 4 (limit: 986) Memory: 4.9M CPU: 9.725s CGroup: /system.</description>
    </item>
    
    <item>
      <title>Linuxä¸‹å®ç°æŒ‚è½½SMBå…±äº«æ–‡ä»¶å¤¹</title>
      <link>https://ruohai.wang/202307/linux-smb-mount/</link>
      <pubDate>Sat, 15 Jul 2023 14:40:06 +0800</pubDate>
      
      <guid>https://ruohai.wang/202307/linux-smb-mount/</guid>
      <description>linuxä¸‹è®¿é—®å±€åŸŸç½‘ä¸Šçš„smbå…±äº«æ–‡ä»¶å¤¹ï¼Œéœ€è¦å®‰è£…cifs-utilsã€‚
apt install cifs-utils è¿™é‡Œå‡å®šå…±äº«æ–‡ä»¶å¤¹çš„ç½‘ç»œä½ç½®æ˜¯http://smb_ip/shareï¼Œç”¨æˆ·åsmbï¼Œå¯†ç 123456ã€‚
mount -t cifs //smb_ip/share /mnt/share -o username=smb,password=123456 -t cifsï¼ŒæŒ‚è½½çš„æ–‡ä»¶ç±»å‹ï¼Œsmbä¸º-t cifsã€‚ //smb_ip/shareï¼Œsmbå…±äº«æ–‡ä»¶å¤¹çš„ç½‘ç»œä½ç½® /mnt/shareï¼Œæœ¬åœ°æŒ‚è½½çš„ä½ç½® -oï¼Œ-oåé¢è·Ÿçš„éƒ½æ˜¯æŒ‚è½½çš„è¯¦ç»†å‚æ•°é…ç½®ï¼Œsmbåè®®ã€ç”¨æˆ·åã€å¯†ç ç­‰ç­‰ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™é‡Œè¯¦ç»†å‚æ•°è§£é‡Šï¼Œæˆ–è€…çœ‹å›¾ç‰‡ã€‚ å¦‚æœè¦è®¾ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½smbï¼Œåœ¨/etc/fstabæ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œï¼Œä¿å­˜é€€å‡ºå³å¯ã€‚
//smb_ip/share /mnt/share cifs username=smb,passwd=123456 0 0 ä¹Ÿå¯ä»¥åœ¨/etc/samba/ç›®å½•ä¸‹æ–°å»ºé…ç½®æ–‡ä»¶smbpasswdç”¨æ¥ä¿å­˜smbçš„ç”¨æˆ·åå’Œå¯†ç ä»¥æ–¹ä¾¿ç®¡ç†ï¼Œå†…å®¹å¦‚ä¸‹ã€‚
username=smb password=123456 ç„¶å fstabä¸­æ·»åŠ ä¸€è¡Œ
//smb_ip/share /mnt/share cifs credentials=/etc/samba/smbpasswd 0 0 fstabçš„æ ¼å¼è§„èŒƒå¦‚ä¸‹
&amp;lt;file system&amp;gt; &amp;lt;dir&amp;gt; &amp;lt;type&amp;gt; &amp;lt;options&amp;gt; &amp;lt;dump&amp;gt; &amp;lt;pass&amp;gt; </description>
    </item>
    
  </channel>
</rss>
