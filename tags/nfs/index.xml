<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>NFS on å–µà¸…^â€¢ï»Œâ€¢^à¸…</title>
    <link>https://ruohai.wang/tags/nfs/</link>
    <description>Recent content in NFS on å–µà¸…^â€¢ï»Œâ€¢^à¸…</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 22 Dec 2024 22:32:26 +0800</lastBuildDate><atom:link href="https://ruohai.wang/tags/nfs/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ä½¿ç”¨systemd-mounté…ç½®nfså’Œsambaå…±äº«çš„å¼€æœºè‡ªåŠ¨æŒ‚è½½</title>
      <link>https://ruohai.wang/202412/systemd-mount-nfs-and-samba/</link>
      <pubDate>Sun, 22 Dec 2024 22:32:26 +0800</pubDate>
      
      <guid>https://ruohai.wang/202412/systemd-mount-nfs-and-samba/</guid>
      <description>å‰è¨€ æœ¬æ–‡æ ¹æ®chatgptçš„å›ç­”è¿›è¡Œæ•´ç†ã€‚
æ­£æ–‡ åœ¨linuxä¸Šç»™é¢å¤–çš„ç¡¬ç›˜é…ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ç¼–è¾‘/etc/fstabæ¥å®Œæˆï¼Œå¾ˆæ–¹ä¾¿ï¼Œä½†è¿™ç§æ–¹å¼ä¸‹ï¼Œå¦‚æœç¡¬ç›˜ä¸¢å¤±ï¼Œå¼€æœºçš„æ—¶å€™å°±éœ€è¦è¿›å…¥æ¢å¤æ¨¡å¼é‡ç½®/etc/fstabæ‰èƒ½æ­£å¸¸è¿›å…¥ç³»ç»Ÿã€‚
systemd-mountæ¨¡å—ä¹Ÿèƒ½å®Œæˆå¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼ˆå®ƒè®¾è®¡å‡ºæ¥å°±æ˜¯æ›¿ä»£/etc/fstabï¼‰ï¼Œè€Œä¸”åœ¨ä¸¢å¤±ç¡¬ç›˜çš„æƒ…å†µä¸‹ä¸ä¼šå½±å“æ­£å¸¸å¼€æœºï¼Œæ‰€ä»¥å°¤å…¶é€‚åˆç”¨å®ƒæ¥æŒ‚è½½nfsæˆ–è€…sambaå…±äº«çš„ç›®å½•ï¼ˆå› ä¸ºå…±äº«ç›®å½•å¾ˆå¯èƒ½ä¼šæ‰çº¿ï¼‰ã€‚
æ‰€ä»¥è®°å½•ä»¥ä¸‹ç”¨systemd-mountæŒ‚è½½nfså’Œsambaçš„æ¨¡æ¿å’Œæ­¥éª¤ã€‚
NFS
å‡å®šè¦æŠŠnfså…±äº«ç›®å½•æŒ‚è½½åˆ°æœ¬åœ°/mnt/nfsã€‚
åœ¨/etc/systemd/systemç›®å½•ä¸‹æ–°å»ºmnt-nfs.mountæ–‡ä»¶ï¼Œæ³¨æ„mnt-nfså¯¹åº”æŒ‚è½½ç‚¹/mnt/nfsï¼Œåå­—å¿…é¡»è¦å¯¹åº”ã€‚
é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹
[Unit] Description=Mount NFS share Wants=network-online.target After=network-online.target [Mount] What=remote_server_ip:/remote/path Where=/mnt/nfs Type=nfs Options=_netdev,auto TimeoutSec=30 [Install] WantedBy=multi-user.target å‚æ•°é‡Šä¹‰ï¼š
Whatï¼šNFS æœåŠ¡å™¨å’Œå…±äº«è·¯å¾„ã€‚å°† remote_server_ip:/remote/path æ›¿æ¢ä¸ºä½ å®é™…çš„ NFS æœåŠ¡å™¨ IP åœ°å€å’Œå…±äº«è·¯å¾„ã€‚ Whereï¼šæŒ‚è½½ç‚¹çš„æœ¬åœ°è·¯å¾„ï¼Œå³ /mnt/nfsã€‚ Typeï¼šæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œè¿™é‡Œæ˜¯ nfsã€‚ Optionsï¼šæŒ‚è½½é€‰é¡¹ï¼Œ_netdev è¡¨ç¤ºç½‘ç»œè®¾å¤‡æŒ‚è½½ï¼Œauto è¡¨ç¤ºåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½ã€‚ TimeoutSecï¼šå¦‚æœæŒ‚è½½æ“ä½œåœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰å®Œæˆï¼Œå°†ç»ˆæ­¢æŒ‚è½½å°è¯•ã€‚ WantedBy=multi-user.targetï¼šä½¿æŒ‚è½½åœ¨ç³»ç»Ÿè¿›å…¥å¤šç”¨æˆ·ç›®æ ‡ï¼ˆå³æ­£å¸¸è¿è¡Œçº§åˆ«ï¼‰æ—¶è¿›è¡Œã€‚ Samba
å‡å®šè¦æŠŠsambaå…±äº«ç›®å½•æŒ‚è½½åˆ°æœ¬åœ°/mnt/smbã€‚
åœ¨/etc/systemd/systemç›®å½•ä¸‹æ–°å»ºmnt-smb.mountæ–‡ä»¶ï¼Œæ³¨æ„mnt-smbå¯¹åº”æŒ‚è½½ç‚¹/mnt/smbï¼Œåå­—å¿…é¡»è¦å¯¹åº”ã€‚
é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹
[Unit] Description=Mount Samba Share After=network.target [Mount] What=//samba-server/share Where=/mnt/smb Type=cifs Options=credentials=/home/username/.smbcredentials,iocharset=utf8,vers=3.0,uid=1000,gid=1000 TimeoutSec=30 [Install] WantedBy=multi-user.target å‚æ•°é‡Šä¹‰ï¼š
Whatï¼šSamba å…±äº«çš„åœ°å€ï¼ˆ//samba-server/shareï¼‰ã€‚ Whereï¼šæŒ‚è½½ç‚¹ï¼ˆ/mnt/smbï¼‰ã€‚ Optionsï¼šæŒ‚è½½é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ã€‚æ¯”å¦‚ credentials æ˜¯æŒ‡ä¸€ä¸ªåŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„æ–‡ä»¶ï¼ˆ/home/username/.smbcredentialsï¼‰ã€‚ TimeoutSecï¼šæŒ‚è½½æ“ä½œçš„è¶…æ—¶è®¾ç½®ï¼ˆå¯æ ¹æ®éœ€è¦è°ƒæ•´ï¼‰ã€‚ æœ€åä¸€æ­¥ï¼šå¯ç”¨æœåŠ¡
å®Œæˆä»¥ä¸Šé…ç½®åï¼Œå¯åŠ¨æœåŠ¡ &amp;amp; è®¾ç½®å¼€æœºå¯åŠ¨</description>
    </item>
    
    <item>
      <title>åœ¨Debianä¸Šéƒ¨ç½²NFSç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ</title>
      <link>https://ruohai.wang/202410/nfs-install-guide/</link>
      <pubDate>Wed, 02 Oct 2024 13:11:11 +0800</pubDate>
      
      <guid>https://ruohai.wang/202410/nfs-install-guide/</guid>
      <description>å‰è¨€ ç©nasçš„å¯¹å„ç§ç½‘ç»œå…±äº«æ–‡ä»¶åè®®è‚¯å®šä¸é™Œç”Ÿï¼Œæ¯”å¦‚smb/sambaã€nfsã€afpã€webdavç­‰ç­‰ã€‚
ä¹‹å‰æˆ‘ä¸€ç›´ç”¨çš„smb/sambaï¼Œä¹Ÿç”¨è¿‡å‡ æ¬¡webdavï¼Œè¿™æ¬¡å°è¯•ä¸‹nfsï¼Œæ°´ç¯‡æ–‡ç« åšä¸ªç®€å•è®°å½•ã€‚
éƒ¨ç½² nfsçš„éƒ¨ç½²åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œä¸¤ç«¯çš„éƒ¨ç½²æ–¹å¼äº›å¾®ä¸åŒã€‚
æœåŠ¡ç«¯ï¼ˆserverï¼‰
é¦–å…ˆæ˜¯å®‰è£…å¿…é¡»çš„è½¯ä»¶åŒ…ï¼Œnfs-commonä½œä¸ºä¾èµ–åŒ…å¿…å®šä¼šå®‰è£…ï¼Œæ‰€ä»¥åœ¨å‘½ä»¤ä¸­ä¸éœ€è¦ä½“ç°
sudo apt install nfs-kernel-server ç„¶åç¼–è¾‘nfsçš„é…ç½®æ–‡ä»¶/etc/exportsï¼Œè®¾å®šå…±äº«ç›®å½•ã€‚
sudo nano /etc/exports æ·»åŠ å…±äº«ç›®å½•çš„é…ç½®ä¿¡æ¯
/path/to/share/folder 192.168.1.111(rw,async) tipsï¼š
/path/to/share/folderï¼šå…±äº«ç›®å½•çš„è·¯å¾„ 192.168.1.111ï¼šæŒ‡å®šå…±äº«å®¢æˆ·ç«¯çš„ipï¼Œä¹Ÿå¯ä»¥ç”¨å­ç½‘æ©ç æ¥æŒ‡å®šç½‘æ®µï¼Œæˆ–è®¸è¿˜æœ‰å…¶å®ƒæŒ‡å®šæ–¹å¼å¯ä»¥è‡ªè¡Œç ”ç©¶ (rw,async)ï¼šæŒ‡å®šå…±äº«ç›®å½•çš„æƒé™ï¼Œå¸¸ç”¨çš„rwï¼ˆå¯è¯»å¯å†™ï¼‰ã€åŒæ­¥å¼‚æ­¥ï¼ˆsync/asyncï¼‰ï¼Œå…¶å®ƒå‚æ•°å¯ä»¥ç­‰éœ€è¦è°ƒä¼˜äº†å†ç¿»é˜…æ–‡æ¡£ é…ç½®å®Œæˆä»¥åï¼Œå¯ä»¥ç›´æ¥é‡å¯nfsæœåŠ¡ç”Ÿæ•ˆ
sudo systemctl restart nfs-server.service ä¹Ÿå¯ä»¥ä¸é‡å¯nfsæœåŠ¡ä¾ç„¶è®©é…ç½®ç”Ÿæ•ˆ
sudo exportfs -arv tips:
-aï¼šå…¨éƒ¨æŒ‚è½½æˆ–å…¨éƒ¨å¸è½½ -rï¼šé‡æ–°æŒ‚è½½ -vï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ å¦‚æœç”µè„‘ä¸Šå¯ç”¨äº†é˜²ç«å¢™ï¼Œéœ€è¦æ”¾è¡Œä¸¤ä¸ªç«¯å£
2049,111/tcp 2049,111/udp å¥½äº†ï¼Œåˆ°è¿™é‡Œnfsçš„æœåŠ¡ç«¯é…ç½®å°±å®Œæˆæƒ¹ã€‚ğŸ‰
å®¢æˆ·ç«¯ï¼ˆclientï¼‰
é¦–å…ˆæ˜¯å®‰è£…å¿…é¡»çš„è½¯ä»¶åŒ…
sudo apt install nfs-common ç„¶åç›´æ¥mountçœ‹ä¸‹èƒ½ä¸èƒ½æŒ‚è½½æˆåŠŸï¼Œå‡å®šæŒ‚è½½åˆ°æœ¬åœ°çš„/mnt/nfsï¼Œå‘½ä»¤ä¸­çš„-t nfsè¿™éƒ¨åˆ†æŒ‡å®šåè®®çš„å†…å®¹å¯ä»¥çœç•¥ã€‚
mount -t nfs 192.168.1.111:/path/to/share/folder /mnt/nfs ä¸å‡ºæ„å¤–çš„è¯å°±æŒ‚è½½æˆåŠŸäº†ã€‚å¦‚æœéœ€è¦æŠŠnfsæ–‡ä»¶å¤¹è®¾ç½®æˆå¼€æœºå¯åŠ¨æŒ‚è½½ï¼Œå¯ä»¥é€šè¿‡ç¼–è¾‘/etc/fstabï¼Œä¹Ÿå¯ä»¥ç”¨systemd-mountæ¥å®ç°ï¼Œè¿™é‡Œä»¥åè€…ä¸ºä¾‹ã€‚åœ¨/etc/systemd/systemç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªmnt-nfs.mountæ–‡ä»¶ï¼ˆæ³¨æ„è¿™ä¸ªæ–‡ä»¶åmnt-nfséœ€è¦å’ŒæŒ‚è½½ç‚¹/mnt/nfsè·¯å¾„å¯¹åº”ï¼‰ï¼Œç„¶åå½•å…¥ä»¥ä¸‹å†…å®¹
[Unit] Description=nfs auto mount After=network.target [Mount] What=192.168.1.111:/path/to/share/folder Where=/mnt/nfs Type=nfs [Install] WantedBy=multi-user.target ä¿å­˜æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤æ·»åŠ ä¸ºç³»ç»ŸæœåŠ¡
# é‡è½½ sudo systemctl daemon-reload # æ·»åŠ æœåŠ¡ &amp;amp; å¼€æœºè‡ªå¯ sudo systemctl enable --now mnt-nfs.</description>
    </item>
    
  </channel>
</rss>
